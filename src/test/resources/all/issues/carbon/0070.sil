field f: Int

method test(x: Ref)
  requires acc(x.f) && x.f != 3
{
  var b: Bool
  b := true
  //:: UnexpectedOutput(while.failed:insufficient.permission, /Silicon/issue/165/)
  while (b)
    //:: ExpectedOutput(not.wellformed:insufficient.permission)
    //:: MissingOutput(not.wellformed:insufficient.permission, /Carbon/issue/70/)
    //:: MissingOutput(not.wellformed:insufficient.permission, /Silicon/issue/165/)
    invariant x != null && x.f != 3 // This is not self-framing.
  {
    //:: UnexpectedOutput(assignment.failed:insufficient.permission, /Carbon/issue/70/)
    x.f := 4  // Loop body should be verified under assumption that invariant
              // is wellformed.
    b := false
  }
}
